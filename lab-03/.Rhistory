stats_us <- nmbd_us %>%
summarise(
mean = mean(VALUE1, na.rm = TRUE),
median = median(VALUE1, na.rm = TRUE),
min = min(VALUE1, na.rm = TRUE),
max = max(VALUE1, na.rm = TRUE),
procentile_25 = quantile(VALUE1, 0.25, na.rm = TRUE),
procentile_75 = quantile(VALUE1, 0.75, na.rm = TRUE)
)
summary_wa
summary_us
nmbd_wide <- nmbd %>%
pivot_wider(
names_from  = SERIESID,
values_from = VALUE1
)
# Compare dimensions
dim(nmbd)       # before (rows and columns)
dim(nmbd_wide)  # after (rows and columns)
ggplot(nmbd %>% filter(GEONAME %in% c("Alaska", "Texas"),VALUE2>100),
aes(x = VALUE2, fill = GEONAME)) +
geom_histogram(bins = 20, alpha = 0.6, position = "identity") +
labs(title = "Outstanding Mortgage Value AK & TX - Distribution",
x = "Mortgage Value", y = "Hz") +
theme_minimal()
nmbd %>%
filter(GEONAME == "Alaska") %>%
group_by(YEAR) %>%
summarise(total_mortgage_value = sum(VALUE1, na.rm = TRUE), .groups = "drop") %>%
ggplot(aes(x = YEAR, y = total_mortgage_value)) +
geom_line(color = "GREEN", linewidth = 6) +
geom_point(color = "BLACK", size = 6) +
labs(title = "Total Mortgage Value per Year in Alaska",
x = "Year",
y = "Total Mortgage Value (VALUE1)") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library('ggplot2') # the major package for visualization in R
hvi <- read_csv("zillow_hvi_msa.csv")
hvi <- read_csv("zillow_hvi_msa.csv",
col_types = cols(
RegionName = col_character(),
StateName  = col_character(),
Region   = col_character(), # Census Bureau Regions
RegionID   = col_double(),
Popu2024   = col_number(),
.default   = col_double()   # for other columns
)
)
head(hvi, 3)
head(hvi, 3)
hvi_tidy <- hvi %>%
pivot_longer( # using `pivot_longer` to reshape wide → long
cols = -c("RegionID", "RegionName", "Popu2024", "StateName", "Region"), # keep these 4 as identifier variables (don’t pivot them)
names_to = "Date",  # old column names (like "1/31/00") become a new column called Date
values_to = "HVI" # the cell values go into a new column called HVI
# values_drop_na = TRUE; default as FALSE; if TRUE, will remove rows with missing HVI.
) %>%
mutate(
Date = as.Date(Date, format = "%m/%d/%y")
)
head(hvi_tidy,3)
hvi_wide <- hvi_tidy %>%
pivot_wider(
names_from = Date,   # expand `Date` to multiple rows
values_from = HVI    # extract`HVI` column to those new columns
)
head(hvi_wide, 3)
colSums(is.na(hvi_tidy))
# remove NA then we can see there are 9237 rows afterwards, 3 missing values are removed
hvi_tidy_NA_remove <- hvi_tidy %>%
filter(!is.na(HVI))
dim(hvi_tidy_NA_remove)
library(zoo)
hvi_tidy_NA_interpolation <- hvi_tidy %>%
mutate(HVI = na.approx(HVI, na.rm = FALSE))
dim(hvi_tidy_NA_interpolation)
# install.packages("skimr") # you only need to install once
library(skimr)
skim(hvi_tidy) # run `skim()` to get a quick overview of the dataset
hvi_pnw <- hvi_tidy_NA_remove %>%
filter(RegionName %in% c("Seattle, WA", "Portland, OR"))
ggplot(hvi_pnw, aes(x = Date, y = HVI, group = RegionName)) # will show below the chunk
g <- ggplot(hvi_pnw, aes(x = Date, y = HVI, color = RegionName)) # will not show the plots
g <- g + geom_line(aes(color = RegionName),
alpha = 0.8, # Opacity: 0 means fully transparent (invisible)
linetype = 6, # 6 = twodash, you can check more option using `?linetype`
linewidth = 0.8) # linewidth
g
g <- g + scale_y_continuous(labels = scales::comma, # format numbers with commas
trans = "log10") # apply base-10 log transformation
g
g <- g + coord_cartesian(xlim = c(as.Date("2010-01-01"), as.Date("2020-6-30")),
ylim = c(NA, 600000)) # we did not define the low bound of y
g
g <- g + facet_wrap(~ RegionName)
g
g <- g +
labs(
x = "Year",                # label for x axis
y = "Home Value Index",    # label for y axis
title = "Seattle and Portland Housing Trend 2010–2020", # main title
subtitle = "Data source: Zillow HVI",      # subtitle
caption = "Visualization using R and ggplot2"     # caption
)
g
g <- g + theme_light(base_size = 12) + # use a minimal theme and the base size as 12
theme(panel.grid.minor = element_blank(), # remove minor grids
legend.position = "none"
)
g
ggsave(
filename = "Seattle and Portland HVI Trend.png",
plot = g,
width = 12,
height = 6,
dpi = 300
) # save the last plot as 12 * 5 inch png file with 300 dpi (dots per inch)
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")), aes(x = Popu2024)) +
geom_histogram(
bins = 10,        # number of bins
color = "white",  # border color
fill = "pink",
alpha = 0.7       # transparency
) +
labs(title = "Histograms of Metropolitan Statistical Area Population", x = "Population (2024)", y = "Count of Cities") +
theme_minimal()
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")), aes(x = Popu2024)) +
geom_histogram(
bins = 10,        # number of bins
binwidth = 100000,
alpha = 0.3       # transparency
) +
labs(title = "Histograms of Metropolitan Statistical Area Population", x = "Population (2024)", y = "Count of Cities") +
geom_dotplot(color = "blue")
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(y = Popu2024, x = Region)
) +
geom_boxplot(
fill = "black",
alpha = 0.3,       # transparency
width = 0.5        # box width
) +
labs(
title = "Boxplot of City Population by Census Bureau Regions",
y = "Population (2024)",
x = NULL
) +
theme_minimal()
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(y = Popu2024, x = Region)
) +
geom_boxplot(
fill = "black",
alpha = 0.3,       # transparency
width = 2,        # box width
) +
labs(
title = "Boxplot of City Population by Census Bureau Regions",
y = "Population (2024)",
x = NULL
) +
geom_jitter(
width = 3,
height = 3
)
?geom_jitter
ggplot(data = hvi_tidy_NA_remove %>%
filter(
RegionName %in% c("Seattle, WA", "New York, NY", "San Francisco, CA")
)) +
stat_ecdf(# stat builds new variables to plot, we build CDF
aes(x = HVI, color = RegionName),) + # we use color to distinguish regions
labs(title = "CDF HVI for Seattle, New York and SF",
subtitle = "F(x) = P(X ≤ x)",
y = "Cumulative Distribution Function (CDF)",
x = "Home Value Index") +
theme_minimal() +
theme(legend.position = "bottom") # because we have `color`, ggplot will generate legend
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(x = Popu2024, y = HVI)
) +
geom_point(alpha = 0.6) +
geom_smooth( # we use a sample linear regression to model the relationship (trends)
method = "lm",
formula = y ~ x,
se = TRUE, # show confidence interval
color = "#4B2E83"
) +
labs(
title = "Scatterplots of City Population and Home Value Index",
x = "Population (2024)",
y = "Home Value Index"
) +
theme_minimal()
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31"))) +
geom_point(aes(x = StateName, y = HVI, size = Popu2024 ), alpha = 0.6) + # bubble size = population
scale_y_continuous(labels = scales::comma) +
scale_size_continuous(range = c(1, 10), labels = scales::comma) +
labs(
title = "Bubble Chart of Population and Home Value Index by State",
x = "State",
y = "Home Value Index",
size = "Population (2024)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1) # rotate state labels
)
ggplot(
data = hvi_tidy_NA_remove
) +
geom_tile(aes(x = Date, y = RegionName, fill = HVI)) +
scale_fill_viridis_c(option = "magma", direction = -1) +
labs(
title = "Home Value Index Over Time by City",
x = "Year",
y = "City"
) +
scale_x_date(date_breaks = "5 year", date_labels = "%Y") +
theme_minimal() +
theme(panel.grid = element_blank())
nmbd <- read_csv("nmdb-outstanding-mortgage-statistics-states-quarterly.csv")
dim(nmbd)
skim(nmbd)
glimpse(nmbd)
head(nmbd, 3)
nmbd_wa <- nmbd %>% filter(GEONAME == "Washington")
nmbd_us <- nmbd %>% filter(GEONAME != "Washington")
stats_wa <- nmbd_wa %>%
summarise(
mean = mean(VALUE1, na.rm = TRUE),
median = median(VALUE1, na.rm = TRUE),
min = min(VALUE2, na.rm = TRUE),
max = max(VALUE2, na.rm = TRUE),
procentile_25 = quantile(VALUE2, 0.25, na.rm = TRUE),
procentile_75 = quantile(VALUE2, 0.75, na.rm = TRUE)
)
stats_us <- nmbd_us %>%
summarise(
mean = mean(VALUE1, na.rm = TRUE),
median = median(VALUE1, na.rm = TRUE),
min = min(VALUE1, na.rm = TRUE),
max = max(VALUE1, na.rm = TRUE),
procentile_25 = quantile(VALUE1, 0.25, na.rm = TRUE),
procentile_75 = quantile(VALUE1, 0.75, na.rm = TRUE)
)
summary_wa
summary_us
nmbd_wide <- nmbd %>%
pivot_wider(
names_from  = SERIESID,
values_from = VALUE1
)
# Compare dimensions
dim(nmbd)       # before (rows and columns)
dim(nmbd_wide)  # after (rows and columns)
ggplot(nmbd %>% filter(GEONAME %in% c("Washington", "California"),VALUE1>100),
aes(x = VALUE1, fill = GEONAME))+
geom_histogram(bins = 20, alpha = 0.2, position = "identity") +
labs(title = "Number of Morgages CA & WA - Distribution",
x = "Number of Mortgages", y = "Hz")+
theme_minimal()
ggplot(nmbd %>% filter(GEONAME %in% c("Alaska", "Texas"),VALUE2>100),
aes(x = VALUE2, fill = GEONAME)) +
geom_histogram(bins = 20, alpha = 0.6, position = "identity") +
labs(title = "Outstanding Mortgage Value AK & TX - Distribution",
x = "Mortgage Value", y = "Hz") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library('ggplot2') # the major package for visualization in R
hvi <- read_csv("zillow_hvi_msa.csv")
hvi <- read_csv("zillow_hvi_msa.csv",
col_types = cols(
RegionName = col_character(),
StateName  = col_character(),
Region   = col_character(), # Census Bureau Regions
RegionID   = col_double(),
Popu2024   = col_number(),
.default   = col_double()   # for other columns
)
)
head(hvi, 3)
head(hvi, 3)
hvi_tidy <- hvi %>%
pivot_longer( # using `pivot_longer` to reshape wide → long
cols = -c("RegionID", "RegionName", "Popu2024", "StateName", "Region"), # keep these 4 as identifier variables (don’t pivot them)
names_to = "Date",  # old column names (like "1/31/00") become a new column called Date
values_to = "HVI" # the cell values go into a new column called HVI
# values_drop_na = TRUE; default as FALSE; if TRUE, will remove rows with missing HVI.
) %>%
mutate(
Date = as.Date(Date, format = "%m/%d/%y")
)
head(hvi_tidy,3)
hvi_wide <- hvi_tidy %>%
pivot_wider(
names_from = Date,   # expand `Date` to multiple rows
values_from = HVI    # extract`HVI` column to those new columns
)
head(hvi_wide, 3)
colSums(is.na(hvi_tidy))
# remove NA then we can see there are 9237 rows afterwards, 3 missing values are removed
hvi_tidy_NA_remove <- hvi_tidy %>%
filter(!is.na(HVI))
dim(hvi_tidy_NA_remove)
library(zoo)
hvi_tidy_NA_interpolation <- hvi_tidy %>%
mutate(HVI = na.approx(HVI, na.rm = FALSE))
dim(hvi_tidy_NA_interpolation)
# install.packages("skimr") # you only need to install once
library(skimr)
skim(hvi_tidy) # run `skim()` to get a quick overview of the dataset
hvi_pnw <- hvi_tidy_NA_remove %>%
filter(RegionName %in% c("Seattle, WA", "Portland, OR"))
ggplot(hvi_pnw, aes(x = Date, y = HVI, group = RegionName)) # will show below the chunk
g <- ggplot(hvi_pnw, aes(x = Date, y = HVI, color = RegionName)) # will not show the plots
g <- g + geom_line(aes(color = RegionName),
alpha = 0.8, # Opacity: 0 means fully transparent (invisible)
linetype = 6, # 6 = twodash, you can check more option using `?linetype`
linewidth = 0.8) # linewidth
g
g <- g + scale_y_continuous(labels = scales::comma, # format numbers with commas
trans = "log10") # apply base-10 log transformation
g
g <- g + coord_cartesian(xlim = c(as.Date("2010-01-01"), as.Date("2020-6-30")),
ylim = c(NA, 600000)) # we did not define the low bound of y
g
g <- g + facet_wrap(~ RegionName)
g
g <- g +
labs(
x = "Year",                # label for x axis
y = "Home Value Index",    # label for y axis
title = "Seattle and Portland Housing Trend 2010–2020", # main title
subtitle = "Data source: Zillow HVI",      # subtitle
caption = "Visualization using R and ggplot2"     # caption
)
g
g <- g + theme_light(base_size = 12) + # use a minimal theme and the base size as 12
theme(panel.grid.minor = element_blank(), # remove minor grids
legend.position = "none"
)
g
ggsave(
filename = "Seattle and Portland HVI Trend.png",
plot = g,
width = 12,
height = 6,
dpi = 300
) # save the last plot as 12 * 5 inch png file with 300 dpi (dots per inch)
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")), aes(x = Popu2024)) +
geom_histogram(
bins = 10,        # number of bins
color = "white",  # border color
fill = "pink",
alpha = 0.7       # transparency
) +
labs(title = "Histograms of Metropolitan Statistical Area Population", x = "Population (2024)", y = "Count of Cities") +
theme_minimal()
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")), aes(x = Popu2024)) +
geom_histogram(
bins = 10,        # number of bins
binwidth = 100000,
alpha = 0.3       # transparency
) +
labs(title = "Histograms of Metropolitan Statistical Area Population", x = "Population (2024)", y = "Count of Cities") +
geom_dotplot(color = "blue")
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(y = Popu2024, x = Region)
) +
geom_boxplot(
fill = "black",
alpha = 0.3,       # transparency
width = 0.5        # box width
) +
labs(
title = "Boxplot of City Population by Census Bureau Regions",
y = "Population (2024)",
x = NULL
) +
theme_minimal()
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(y = Popu2024, x = Region)
) +
geom_boxplot(
fill = "black",
alpha = 0.3,       # transparency
width = 2,        # box width
) +
labs(
title = "Boxplot of City Population by Census Bureau Regions",
y = "Population (2024)",
x = NULL
) +
geom_jitter(
width = 3,
height = 3
)
?geom_jitter
ggplot(data = hvi_tidy_NA_remove %>%
filter(
RegionName %in% c("Seattle, WA", "New York, NY", "San Francisco, CA")
)) +
stat_ecdf(# stat builds new variables to plot, we build CDF
aes(x = HVI, color = RegionName),) + # we use color to distinguish regions
labs(title = "CDF HVI for Seattle, New York and SF",
subtitle = "F(x) = P(X ≤ x)",
y = "Cumulative Distribution Function (CDF)",
x = "Home Value Index") +
theme_minimal() +
theme(legend.position = "bottom") # because we have `color`, ggplot will generate legend
ggplot(
data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31")),
aes(x = Popu2024, y = HVI)
) +
geom_point(alpha = 0.6) +
geom_smooth( # we use a sample linear regression to model the relationship (trends)
method = "lm",
formula = y ~ x,
se = TRUE, # show confidence interval
color = "#4B2E83"
) +
labs(
title = "Scatterplots of City Population and Home Value Index",
x = "Population (2024)",
y = "Home Value Index"
) +
theme_minimal()
ggplot(data = hvi_tidy_NA_remove %>%
filter(Date == as.Date("2025-08-31"))) +
geom_point(aes(x = StateName, y = HVI, size = Popu2024 ), alpha = 0.6) + # bubble size = population
scale_y_continuous(labels = scales::comma) +
scale_size_continuous(range = c(1, 10), labels = scales::comma) +
labs(
title = "Bubble Chart of Population and Home Value Index by State",
x = "State",
y = "Home Value Index",
size = "Population (2024)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1) # rotate state labels
)
ggplot(
data = hvi_tidy_NA_remove
) +
geom_tile(aes(x = Date, y = RegionName, fill = HVI)) +
scale_fill_viridis_c(option = "magma", direction = -1) +
labs(
title = "Home Value Index Over Time by City",
x = "Year",
y = "City"
) +
scale_x_date(date_breaks = "5 year", date_labels = "%Y") +
theme_minimal() +
theme(panel.grid = element_blank())
nmbd <- read_csv("nmdb-outstanding-mortgage-statistics-states-quarterly.csv")
dim(nmbd)
skim(nmbd)
glimpse(nmbd)
head(nmbd, 3)
nmbd_wa <- nmbd %>% filter(GEONAME == "Washington")
nmbd_us <- nmbd %>% filter(GEONAME != "Washington")
summary_wa <- nmbd_wa %>%
summarise(
mean = mean(VALUE1, na.rm = TRUE),
median = median(VALUE1, na.rm = TRUE),
min = min(VALUE2, na.rm = TRUE),
max = max(VALUE2, na.rm = TRUE),
procentile_25 = quantile(VALUE2, 0.25, na.rm = TRUE),
procentile_75 = quantile(VALUE2, 0.75, na.rm = TRUE)
)
summary_us <- nmbd_us %>%
summarise(
mean = mean(VALUE1, na.rm = TRUE),
median = median(VALUE1, na.rm = TRUE),
min = min(VALUE1, na.rm = TRUE),
max = max(VALUE1, na.rm = TRUE),
procentile_25 = quantile(VALUE1, 0.25, na.rm = TRUE),
procentile_75 = quantile(VALUE1, 0.75, na.rm = TRUE)
)
summary_wa
summary_us
nmbd_wide <- nmbd %>%
pivot_wider(
names_from  = SERIESID,
values_from = VALUE1
)
# Compare dimensions
dim(nmbd)       # before (rows and columns)
dim(nmbd_wide)  # after (rows and columns)
